<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 4 Manipulating sequences with Biostrings | Bioinformatics" />
<meta property="og:type" content="book" />

<meta property="og:description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain." />


<meta name="author" content="Laurent Gatto" />

<meta name="date" content="2025-10-14" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain.">

<title>Chapter 4 Manipulating sequences with Biostrings | Bioinformatics</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Bioinformatics<p><p class="author">Laurent Gatto</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html" id="toc-preamble">Preamble</a>
<a href="sec-refresher.html" id="toc-sec-refresher"><span class="toc-section-number">1</span> R refresher</a>
<a href="sec-vis.html" id="toc-sec-vis"><span class="toc-section-number">2</span> Data visualisation</a>
<a href="sec-obj.html" id="toc-sec-obj"><span class="toc-section-number">3</span> High-level data structures</a>
<a id="active-page" href="sec-biostrings.html" id="toc-sec-biostrings"><span class="toc-section-number">4</span> Manipulating sequences with Biostrings</a><ul class="toc-sections">
<li class="toc"><a href="#working-with-sequences---a-first-start"> Working with sequences - a first start</a></li>
<li class="toc"><a href="#working-with-sequences---using-biostrings"> Working with sequences - using <code>Biostrings</code></a></li>
<li class="toc"><a href="#reading-dna-sequence-data-from-a-file"> Reading DNA sequence data from a file</a></li>
<li class="toc"><a href="#tidy-bioconductor"> Tidy Bioconductor</a></li>
<li class="toc"><a href="#subsetting-sequences"> Subsetting sequences</a></li>
<li class="toc"><a href="#working-with-genomes"> Working with genomes</a></li>
<li class="toc"><a href="#additional-exercises-3"> Additional exercises</a></li>
</ul>
<a href="sec-norm.html" id="toc-sec-norm"><span class="toc-section-number">5</span> Data normalisation: centring, scaling, quantile normalisation</a>
<a href="sec-mlintro.html" id="toc-sec-mlintro"><span class="toc-section-number">6</span> Introduction to statistical machine learning</a>
<a href="sec-testing.html" id="toc-sec-testing"><span class="toc-section-number">7</span> Hypothesis testing</a>
<a href="sec-dimred.html" id="toc-sec-dimred"><span class="toc-section-number">8</span> Unsupervised learning: dimensionality reduction</a>
<a href="sec-ul.html" id="toc-sec-ul"><span class="toc-section-number">9</span> Unsupervised learning: clustering</a>
<a href="sec-sl.html" id="toc-sec-sl"><span class="toc-section-number">10</span> Supervised learning</a>
<a href="sec-biovis.html" id="toc-sec-biovis"><span class="toc-section-number">11</span> Visualising biomolecular data</a>
<a href="sec-ccl.html" id="toc-sec-ccl"><span class="toc-section-number">12</span> Conclusions</a>
<a href="sec-si.html" id="toc-sec-si"><span class="toc-section-number">13</span> Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="sec-biostrings" class="section level1" number="4">
<h1>
<span class="header-section-number">Chapter 4</span> Manipulating sequences with Biostrings</h1>
<p><strong>Learning objectives</strong></p>
<p>In this chapter, we will learn about a new object, that is
specialised for the manipulation of biological sequences.</p>
<ul>
<li>Learn about the fasta format format for biological sequences.</li>
<li>Learn about the <code>*StringSet</code> classes.</li>
<li>Working with whole genomes.</li>
<li>Find patterns in sequence data.</li>
</ul>
<p>This chapter is based on the course material presented by Martin
Morgan during the <a href="https://uclouvain-cbio.github.io/BSS2019/">Bioinformatics Summer School
2019</a> at Louvain-la-Neuve,
Belgium.</p>
<div id="working-with-sequences---a-first-start" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Working with sequences - a first start<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('working-with-sequences---a-first-start')" onmouseout="reset_tooltip('working-with-sequences---a-first-start-tooltip')"><span class="tooltiptext" id="working-with-sequences---a-first-start-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>It is easy to use standard R character vectors to define DNA
sequences. Below, we create a vector with three short sequences.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sec-biostrings.html#cb126-1" tabindex="-1"></a>sequences <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AAATCGA"</span>, <span class="st">"ATACAACAT"</span>, <span class="st">"TTGCCA"</span>)</span>
<span id="cb126-2"><a href="sec-biostrings.html#cb126-2" tabindex="-1"></a>sequences</span></code></pre></div>
<pre><code>## [1] "AAATCGA"   "ATACAACAT" "TTGCCA"</code></pre>
<p>We can ask about properties of these sequences and perform some
operations using base R function:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="sec-biostrings.html#cb128-1" tabindex="-1"></a><span class="fu">length</span>(sequences)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="sec-biostrings.html#cb130-1" tabindex="-1"></a><span class="fu">nchar</span>(sequences)</span></code></pre></div>
<pre><code>## [1] 7 9 6</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="sec-biostrings.html#cb132-1" tabindex="-1"></a>sequences[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span></code></pre></div>
<pre><code>## [1] "AAATCGA" "TTGCCA"</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sec-biostrings.html#cb134-1" tabindex="-1"></a><span class="fu">sample</span>(sequences)</span></code></pre></div>
<pre><code>## [1] "TTGCCA"    "AAATCGA"   "ATACAACAT"</code></pre>
<p>However, once we want to perform biologically relevant operations,
base R fails us; it has no notion of operations relevant to DNA
sequences, e.g.,</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sec-biostrings.html#cb136-1" tabindex="-1"></a><span class="fu">reverseComplement</span>(sequences)</span></code></pre></div>
<p>Likewise, we can name a variable anything, the semantic meaning
of the variable name is not enforced by R</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="sec-biostrings.html#cb137-1" tabindex="-1"></a>not_a_dna_sequence <span class="ot">&lt;-</span> <span class="st">"I love R"</span></span></code></pre></div>
</div>
<div id="working-with-sequences---using-biostrings" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Working with sequences - using <code>Biostrings</code>
<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('working-with-sequences---using-biostrings')" onmouseout="reset_tooltip('working-with-sequences---using-biostrings-tooltip')"><span class="tooltiptext" id="working-with-sequences---using-biostrings-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The Bioconductor <em><a href="https://bioconductor.org/packages/3.21/Biostrings">Biostrings</a></em>
package can do all that base R can do, in addition to knowing about
the semantics of the sequences is handles. Let’s start by loading the
package:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="sec-biostrings.html#cb138-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Biostrings"</span>)</span></code></pre></div>
<p>For more information about the <code>Biostrings</code> package, see the vignettes
available online the <a href="https://www.bioconductor.org/packages/release/bioc/html/Biostrings.html">package
package</a>.</p>
<div id="dnastringset" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> <code>DNAStringSet()</code>
<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('dnastringset')" onmouseout="reset_tooltip('dnastringset-tooltip')"><span class="tooltiptext" id="dnastringset-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The <code>DNAStringSet</code> class that <em>knows</em> about DNA sequences. We can
easily create a <code>DNAStringSet</code> from our character vector with</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="sec-biostrings.html#cb139-1" tabindex="-1"></a>dna <span class="ot">&lt;-</span> <span class="fu">DNAStringSet</span>(sequences)</span>
<span id="cb139-2"><a href="sec-biostrings.html#cb139-2" tabindex="-1"></a>dna</span></code></pre></div>
<pre><code>## DNAStringSet object of length 3:
##     width seq
## [1]     7 AAATCGA
## [2]     9 ATACAACAT
## [3]     6 TTGCCA</code></pre>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Does the object <code>dna</code> support the operations illustrated above for a
character vector, especially <code>length()</code>, <code>nchar()</code>, <code>[</code>, and
<code>sample()</code>?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-14" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-14', 'sol-start-14')"></span>
</p>
<div id="sol-body-14" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="sec-biostrings.html#cb141-1" tabindex="-1"></a><span class="fu">length</span>(dna)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="sec-biostrings.html#cb143-1" tabindex="-1"></a><span class="fu">nchar</span>(dna)</span></code></pre></div>
<pre><code>## [1] 7 9 6</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="sec-biostrings.html#cb145-1" tabindex="-1"></a>dna[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span></code></pre></div>
<pre><code>## DNAStringSet object of length 2:
##     width seq
## [1]     7 AAATCGA
## [2]     6 TTGCCA</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="sec-biostrings.html#cb147-1" tabindex="-1"></a><span class="fu">sample</span>(dna)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 3:
##     width seq
## [1]     9 ATACAACAT
## [2]     6 TTGCCA
## [3]     7 AAATCGA</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Prove to yourself that at least some other useful, DNA-specific,
functions exist, e.g., <code>reverse()</code> and <code>reverseComplement()</code>.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-15" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-15', 'sol-start-15')"></span>
</p>
<div id="sol-body-15" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="sec-biostrings.html#cb149-1" tabindex="-1"></a><span class="fu">reverse</span>(dna)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 3:
##     width seq
## [1]     7 AGCTAAA
## [2]     9 TACAACATA
## [3]     6 ACCGTT</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="sec-biostrings.html#cb151-1" tabindex="-1"></a><span class="fu">reverseComplement</span>(dna)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 3:
##     width seq
## [1]     7 TCGATTT
## [2]     9 ATGTTGTAT
## [3]     6 TGGCAA</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What happens when you try to create a <code>DNAStringSet()</code> from an object
such as <code>not_a_dna_sequence</code>, defined above, that does not contain a
DNA sequence? Warning: the message is quite cryptic, can you provide a
‘human’ translation?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-16" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-16', 'sol-start-16')"></span>
</p>
<div id="sol-body-16" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="sec-biostrings.html#cb153-1" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">DNAStringSet</span>(not_a_dna_sequence))</span></code></pre></div>
<pre><code>## Error in .Call2("new_XString_from_CHARACTER", class(x0), string, start,  : 
##   key 73 (char 'I') not in lookup table</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Why does <code>DNAStringSet("ACGTMRW")</code> not create an error, since <code>MRW</code>
are not standard nucleotides? For hints, see the section ’The DNA
alphabet:” in the help page <code>?DNAString</code> and the <code>?IUPAC_CODE_MAP</code>
manual.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What is the difference between a <code>DNAString</code> and a <code>DNAStringSet</code>?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-17" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-17', 'sol-start-17')"></span>
</p>
<div id="sol-body-17" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="sec-biostrings.html#cb155-1" tabindex="-1"></a><span class="fu">DNAString</span>(<span class="st">"AGACCATG"</span>)</span></code></pre></div>
<pre><code>## 8-letter DNAString object
## seq: AGACCATG</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="sec-biostrings.html#cb157-1" tabindex="-1"></a><span class="fu">DNAStringSet</span>(<span class="fu">c</span>(<span class="st">"AGACCATG"</span>, <span class="st">"AAAAAATTTA"</span>))</span></code></pre></div>
<pre><code>## DNAStringSet object of length 2:
##     width seq
## [1]     8 AGACCATG
## [2]    10 AAAAAATTTA</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="learning-more-about-a-class" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Learning more about a class<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('learning-more-about-a-class')" onmouseout="reset_tooltip('learning-more-about-a-class-tooltip')"><span class="tooltiptext" id="learning-more-about-a-class-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The function <code>DNAStringSet()</code> returns an <em>object</em> that has a
particular class</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="sec-biostrings.html#cb159-1" tabindex="-1"></a><span class="fu">class</span>(dna)</span></code></pre></div>
<pre><code>## [1] "DNAStringSet"
## attr(,"package")
## [1] "Biostrings"</code></pre>
<p>Associated with the class are a series of <em>methods</em> (i.e. functions
that have a behaviour that is tuned for that class) that operate on
the class.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Discover many (unfortunately, not all) methods acting on
an object of class <code>DNAStringSet</code> using <code>methods(class = "DNAStringSet")</code>. Verify that <code>reverseComplement</code> is among those
methods.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Help pages describing a particular method can be found using <code>?</code>, with
the search query quoted and with tab-completion providing hints on
what the appropriate help topic is.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Find the help page for the <code>reverseComplement</code> method operating on a
<code>DNAStringSet</code> object, using <code>?reverseComplement</code>.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Help pages provide a description of the technical details required for
creating classes and using methods. Vignettes provide a more narrative
description of overall package use.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Use <code>browseVignettes(package = "Biostrings")</code> to see vignettes
available for this package; explore a few vignettes to get a sense of
possible content.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="reading-dna-sequence-data-from-a-file" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Reading DNA sequence data from a file<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('reading-dna-sequence-data-from-a-file')" onmouseout="reset_tooltip('reading-dna-sequence-data-from-a-file-tooltip')"><span class="tooltiptext" id="reading-dna-sequence-data-from-a-file-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>It is unlikely that we would enter 1000’s of DNA sequences ‘by
hand’. Instead, we might read the data from a standard file
format. For DNA sequences the standard file format is often a ‘FASTA’
file, sometimes abbreviated with an extension <code>.fa</code> and often
compressed with an additional extension <code>.fa.gz</code>. An example of a
FASTA file containing DNA sequences of the 2000bp upstream nucleotides
of all genes annotated in the <em>Drosophila melanogaster</em> <code>dm3</code> genome
build, is distributed with the <code>Biostrings</code> package. Here’s the path
to the FASTA file.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="sec-biostrings.html#cb161-1" tabindex="-1"></a>fa_file <span class="ot">&lt;-</span></span>
<span id="cb161-2"><a href="sec-biostrings.html#cb161-2" tabindex="-1"></a>    <span class="fu">system.file</span>(<span class="at">package=</span><span class="st">"Biostrings"</span>, <span class="st">"extdata"</span>, <span class="st">"dm3_upstream2000.fa.gz"</span>)</span></code></pre></div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Take a peak at the structure of a FASTA file by looking at the first
five lines. You can use the <code>readLines</code> function, setting the <code>n</code>
parameter to read only a limited number of files (see <code>readLines</code>).</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-18" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-18', 'sol-start-18')"></span>
</p>
<div id="sol-body-18" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="sec-biostrings.html#cb162-1" tabindex="-1"></a><span class="fu">readLines</span>(fa_file, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] "&gt;NM_078863_up_2000_chr2L_16764737_f chr2L:16764737-16766736"
## [2] "gttggtggcccaccagtgccaaaatacacaagaagaagaaacagcatctt"         
## [3] "gacactaaaatgcaaaaattgctttgcgtcaatgactcaaaacgaaaatg"         
## [4] "tttttgtgcttttcgaacaaaaaattgggagcagaatattggattcgctt"         
## [5] "ttttcgcatcgaatatcttaagggagcaagggaagaaccatctagaataa"</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>In this case, the first line is an identifier, containing information
about the gene <code>NM_078863</code> as well as the genomic coordinates of the
sequence <code>chr2L:16764737-16766736</code>. The next lines are the DNA
sequence. After a certain number of lines, a new record starts.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="sec-biostrings.html#cb164-1" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">readLines</span>(fa_file, <span class="dv">44</span>), <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] "cacgcacaccgatcgtcgaatcgaaaagctttcggggtcttacgggatcc"         
## [2] "atgggtatcaagttgccccgtataaaaggcaagtttaccggttgcacggt"         
## [3] "&gt;NM_001201794_up_2000_chr2L_8382455_f chr2L:8382455-8384454"
## [4] "ttatttatgtaggcgcccgttcccgcagccaaagcactcagaattccggg"         
## [5] "cgtgtagcgcaacgaccatctacaaggcaatattttgatcgcttgttagg"</code></pre>
<p>We could fairly <em>easily</em> write our own parser for this format, but
this would be error-prone and unnecessary. Instread, we want to use
the <code>readDNAStringSet</code> function from the <code>Biostrings</code> package for
that.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="sec-biostrings.html#cb166-1" tabindex="-1"></a>dna <span class="ot">&lt;-</span> <span class="fu">readDNAStringSet</span>(fa_file)</span>
<span id="cb166-2"><a href="sec-biostrings.html#cb166-2" tabindex="-1"></a>dna</span></code></pre></div>
<pre><code>## DNAStringSet object of length 26454:
##         width seq                                           names               
##     [1]  2000 GTTGGTGGCCCACCAGTGCCA...CAAGTTTACCGGTTGCACGGT NM_078863_up_2000...
##     [2]  2000 TTATTTATGTAGGCGCCCGTT...ATACGGAAAGTCATCCTCGAT NM_001201794_up_2...
##     [3]  2000 TTATTTATGTAGGCGCCCGTT...ATACGGAAAGTCATCCTCGAT NM_001201795_up_2...
##     [4]  2000 TTATTTATGTAGGCGCCCGTT...ATACGGAAAGTCATCCTCGAT NM_001201796_up_2...
##     [5]  2000 TTATTTATGTAGGCGCCCGTT...ATACGGAAAGTCATCCTCGAT NM_001201797_up_2...
##     ...   ... ...
## [26450]  2000 ATTTACAAGACTAATAAAGAT...AAAATTAAATTTCAATAAAAC NM_001111010_up_2...
## [26451]  2000 GATATACGAAGGACGACCTGC...TTGTTTGAGTTGTTATATATT NM_001015258_up_2...
## [26452]  2000 GATATACGAAGGACGACCTGC...TTGTTTGAGTTGTTATATATT NM_001110997_up_2...
## [26453]  2000 GATATACGAAGGACGACCTGC...TTGTTTGAGTTGTTATATATT NM_001276245_up_2...
## [26454]  2000 CGTATGTATTAGTTAACTCTG...TCAAAGTGTAAGAACAAATTG NM_001015497_up_2...</code></pre>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Query the object for basic properties, e.g., it’s <code>length()</code> and that
number of character in each sequence (try <code>table(nchar(dna))</code>).</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Use <code>letterFrequency()</code> to determine GC content of each of the DNA
sequences in <code>dna</code>. The <code>letters</code> argument should be <code>"GC"</code>; <code>as.prob = TRUE</code> returns values between 0 and 1. The data is returned as a
matrix with 1 column.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-19" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-19', 'sol-start-19')"></span>
</p>
<div id="sol-body-19" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="sec-biostrings.html#cb168-1" tabindex="-1"></a>gc_content <span class="ot">&lt;-</span> <span class="fu">letterFrequency</span>(dna, <span class="at">letters =</span> <span class="st">"GC"</span>, <span class="at">as.prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-2"><a href="sec-biostrings.html#cb168-2" tabindex="-1"></a><span class="fu">head</span>(gc_content)</span></code></pre></div>
<pre><code>##         G|C
## [1,] 0.3785
## [2,] 0.4300
## [3,] 0.4300
## [4,] 0.4300
## [5,] 0.4300
## [6,] 0.4300</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What are the mean and standard deviation of the GC contents in the 26454 genes?
What genes(s) has/have the highes GC content?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-20" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-20', 'sol-start-20')"></span>
</p>
<div id="sol-body-20" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="sec-biostrings.html#cb170-1" tabindex="-1"></a><span class="fu">mean</span>(gc_content)</span></code></pre></div>
<pre><code>## [1] 0.4228301</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="sec-biostrings.html#cb172-1" tabindex="-1"></a><span class="fu">sd</span>(gc_content)</span></code></pre></div>
<pre><code>## [1] 0.04935743</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="sec-biostrings.html#cb174-1" tabindex="-1"></a><span class="fu">range</span>(gc_content)</span></code></pre></div>
<pre><code>## [1] 0.0800 0.6145</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="sec-biostrings.html#cb176-1" tabindex="-1"></a>dna[<span class="fu">which</span>(gc_content <span class="sc">==</span> <span class="fu">max</span>(gc_content))]</span></code></pre></div>
<pre><code>## DNAStringSet object of length 1:
##     width seq                                               names               
## [1]  2000 CGCTACTACGGCGCCAGTTCGGC...GCGCTTGCTAAAGCACTCTGGTC NM_133087_up_2000...</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Plot the distribution of GC frequencies in the <code>dna</code> object using base
graphics <code>hist()</code> and <code>plot(density())</code>, and using <code>ggplot()</code>.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-21" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-21', 'sol-start-21')"></span>
</p>
<div id="sol-body-21" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="sec-biostrings.html#cb178-1" tabindex="-1"></a><span class="fu">hist</span>(gc_content)</span></code></pre></div>
<p><img src="WSBIM1322_files/figure-html/letterfreqex3a-1.png" width="672"></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="sec-biostrings.html#cb179-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(gc_content))</span></code></pre></div>
<p><img src="WSBIM1322_files/figure-html/letterfreqex3a-2.png" width="672"></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="sec-biostrings.html#cb180-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb180-2"><a href="sec-biostrings.html#cb180-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(gc_content) <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="sec-biostrings.html#cb180-3" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">G|C</span><span class="st">`</span>))</span>
<span id="cb180-4"><a href="sec-biostrings.html#cb180-4" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="WSBIM1322_files/figure-html/letterfreqex3b-1.png" width="672"></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="sec-biostrings.html#cb182-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="WSBIM1322_files/figure-html/letterfreqex3b-2.png" width="672"></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="tidy-bioconductor" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Tidy Bioconductor<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('tidy-bioconductor')" onmouseout="reset_tooltip('tidy-bioconductor-tooltip')"><span class="tooltiptext" id="tidy-bioconductor-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Although <em>Bioconductor</em> emphasizes formal objects like <code>DNAStringSet</code>
rather than <code>tibble</code>-like data frames, some of the ways one interacts with tidy data can be
applied to Bioconductor objects. For instance, the GC content example
might be written in ‘traditional’ form as</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="sec-biostrings.html#cb183-1" tabindex="-1"></a>gc <span class="ot">&lt;-</span> <span class="fu">letterFrequency</span>(dna, <span class="st">"GC"</span>, <span class="at">as.prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>but could be written using pipes and to reesult in a tibble for easier
down-stream manipulation</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="sec-biostrings.html#cb184-1" tabindex="-1"></a>gc <span class="ot">&lt;-</span></span>
<span id="cb184-2"><a href="sec-biostrings.html#cb184-2" tabindex="-1"></a>    dna <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="sec-biostrings.html#cb184-3" tabindex="-1"></a>    <span class="fu">letterFrequency</span>(<span class="st">"GC"</span>, <span class="at">as.prob =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="sec-biostrings.html#cb184-4" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span>
<span id="cb184-5"><a href="sec-biostrings.html#cb184-5" tabindex="-1"></a>gc</span></code></pre></div>
<pre><code>## # A tibble: 26,454 × 1
##    `G|C`
##    &lt;dbl&gt;
##  1 0.378
##  2 0.43 
##  3 0.43 
##  4 0.43 
##  5 0.43 
##  6 0.43 
##  7 0.43 
##  8 0.43 
##  9 0.43 
## 10 0.43 
## # ℹ 26,444 more rows</code></pre>
</div>
<div id="subsetting-sequences" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Subsetting sequences<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('subsetting-sequences')" onmouseout="reset_tooltip('subsetting-sequences-tooltip')"><span class="tooltiptext" id="subsetting-sequences-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>As <code>[</code> is used to subset a <code>DNAStringSet</code>, it can’t be used to take
substrings of a sequence. This can be done with the <code>subseq</code> sequence.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="sec-biostrings.html#cb186-1" tabindex="-1"></a><span class="fu">subseq</span>(dna, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 26454:
##         width seq                                           names               
##     [1]   100 GTTGGTGGCCCACCAGTGCCA...CAATGACTCAAAACGAAAATG NM_078863_up_2000...
##     [2]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201794_up_2...
##     [3]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201795_up_2...
##     [4]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201796_up_2...
##     [5]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201797_up_2...
##     ...   ... ...
## [26450]   100 ATTTACAAGACTAATAAAGAT...GTGGGCGTTGCAACATGGATC NM_001111010_up_2...
## [26451]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001015258_up_2...
## [26452]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001110997_up_2...
## [26453]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001276245_up_2...
## [26454]   100 CGTATGTATTAGTTAACTCTG...TTACTGTAGTTAGGAAGATTA NM_001015497_up_2...</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="sec-biostrings.html#cb188-1" tabindex="-1"></a><span class="fu">subseq</span>(dna, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 26454:
##         width seq                                           names               
##     [1]   100 GTTGGTGGCCCACCAGTGCCA...CAATGACTCAAAACGAAAATG NM_078863_up_2000...
##     [2]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201794_up_2...
##     [3]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201795_up_2...
##     [4]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201796_up_2...
##     [5]   100 TTATTTATGTAGGCGCCCGTT...ATATTTTGATCGCTTGTTAGG NM_001201797_up_2...
##     ...   ... ...
## [26450]   100 ATTTACAAGACTAATAAAGAT...GTGGGCGTTGCAACATGGATC NM_001111010_up_2...
## [26451]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001015258_up_2...
## [26452]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001110997_up_2...
## [26453]   100 GATATACGAAGGACGACCTGC...ATGACAGTCTTCTGGTGCTGG NM_001276245_up_2...
## [26454]   100 CGTATGTATTAGTTAACTCTG...TTACTGTAGTTAGGAAGATTA NM_001015497_up_2...</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="sec-biostrings.html#cb190-1" tabindex="-1"></a><span class="fu">subseq</span>(dna[[<span class="dv">1</span>]], <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 10-letter DNAString object
## seq: GTTGGTGGCC</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="sec-biostrings.html#cb192-1" tabindex="-1"></a><span class="fu">subseq</span>(dna[[<span class="dv">1</span>]], <span class="at">start =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 10-letter DNAString object
## seq: GTTGGTGGCC</code></pre>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>The start, end and width arguments can be vector of length &gt; 1
themselves so as to generate sequences of different lengths. Create a
new object that contains subsets of the first sequence of <code>dna</code> with,
respectively nucleotides 1 to 1, 1 to 2, 1 to 3, …, 1 to 10.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-22" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-22', 'sol-start-22')"></span>
</p>
<div id="sol-body-22" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="sec-biostrings.html#cb194-1" tabindex="-1"></a>dna[<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>)] <span class="sc">%&gt;%</span>               <span class="co"># DNAStringSet with first sequence 10 times</span></span>
<span id="cb194-2"><a href="sec-biostrings.html#cb194-2" tabindex="-1"></a>    <span class="fu">subseq</span>(<span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># subsequences of 1, 2, ... 10 nucleotides</span></span></code></pre></div>
<pre><code>## DNAStringSet object of length 10:
##      width seq                                              names               
##  [1]     1 G                                                NM_078863_up_2000...
##  [2]     2 GT                                               NM_078863_up_2000...
##  [3]     3 GTT                                              NM_078863_up_2000...
##  [4]     4 GTTG                                             NM_078863_up_2000...
##  [5]     5 GTTGG                                            NM_078863_up_2000...
##  [6]     6 GTTGGT                                           NM_078863_up_2000...
##  [7]     7 GTTGGTG                                          NM_078863_up_2000...
##  [8]     8 GTTGGTGG                                         NM_078863_up_2000...
##  [9]     9 GTTGGTGGC                                        NM_078863_up_2000...
## [10]    10 GTTGGTGGCC                                       NM_078863_up_2000...</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="working-with-genomes" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Working with genomes<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('working-with-genomes')" onmouseout="reset_tooltip('working-with-genomes-tooltip')"><span class="tooltiptext" id="working-with-genomes-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p><code>BSgenome</code> packages contain whole genome sequences as distributed by
ENSEMBL, NCBI and others. In this next example we will load the whole
genome sequence for Drosophila melanogaster from UCSC’s dm2 build, and
calculate the GC content across chromosome 2L.</p>
<p>We first define the genomic range corresponding to chromosome 2L:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="sec-biostrings.html#cb196-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"Biostrings"</span>)</span>
<span id="cb196-2"><a href="sec-biostrings.html#cb196-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"BSgenome.Dmelanogaster.UCSC.dm2"</span>)</span>
<span id="cb196-3"><a href="sec-biostrings.html#cb196-3" tabindex="-1"></a></span>
<span id="cb196-4"><a href="sec-biostrings.html#cb196-4" tabindex="-1"></a>chr2L_range <span class="ot">&lt;-</span> <span class="fu">GRanges</span>(<span class="st">"chr2L"</span>, <span class="fu">IRanges</span>(<span class="dv">1</span>, <span class="fu">seqlengths</span>(Dmelanogaster)[<span class="st">"chr2L"</span>]))</span>
<span id="cb196-5"><a href="sec-biostrings.html#cb196-5" tabindex="-1"></a>chr2L_range</span></code></pre></div>
<pre><code>## GRanges object with 1 range and 0 metadata columns:
##       seqnames     ranges strand
##          &lt;Rle&gt;  &lt;IRanges&gt;  &lt;Rle&gt;
##   [1]    chr2L 1-22407834      *
##   -------
##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</code></pre>
<p>We can now use the <code>getSeq()</code> fonction to extract the actual sequence
for the genome as a <code>DNAStringSet</code> object. We can use it as is to get
the whole genome …</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="sec-biostrings.html#cb198-1" tabindex="-1"></a><span class="fu">getSeq</span>(Dmelanogaster)</span></code></pre></div>
<pre><code>## DNAStringSet object of length 13:
##         width seq                                           names               
##  [1] 22407834 CGACAATGCACGACAGAGGAA...TTAGTTGAAGGTGAGGGTGCT chr2L
##  [2] 20766785 CAGGTACAGTATTCAGTACAG...CTGTTTGCATTCTAGGAATTC chr2R
##  [3] 23771897 TAGGGAGAAATATGATCGCGT...AAAGAGAAGCCTATACTTGGG chr3L
##  [4] 27905053 GAATTCTCTCTTGTTGTAGTC...CTGTTCGCATTCTAGGAATTC chr3R
##  [5]  1281640 GAATTCGCGTCCGCTTACCCA...ATGTAGTATTTTTGTAAGCTT chr4
##  ...      ... ...
##  [9]  1694122 ATTTTACGATACTGCTTATTT...CTAGGAAATTGGCAAAAACTC chr2h
## [10]  2955737 ACCTCAGGAGTCCGAAGTATG...AGATATCTCCATGATACTGAG chr3h
## [11]    88110 ACAAGGCAAGGCAAGGCAAGG...AGTTCGTCAAATGATTAAAAA chr4h
## [12]   359526 ATGCCAAAAAATTGGAATTTC...AGATAGATAGATAGATAGATA chrXh
## [13]   396896 CCAAAGGTTATCCAATCCGGA...ACTATAATAGACTTTATCCTA chrYh</code></pre>
<p>… or extract the region of interest with the <code>GRranges</code> object
previously defined:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="sec-biostrings.html#cb200-1" tabindex="-1"></a>chr2L_dna <span class="ot">&lt;-</span> <span class="fu">getSeq</span>(Dmelanogaster, chr2L_range)</span>
<span id="cb200-2"><a href="sec-biostrings.html#cb200-2" tabindex="-1"></a>chr2L_dna</span></code></pre></div>
<pre><code>## DNAStringSet object of length 1:
##        width seq
## [1] 22407834 CGACAATGCACGACAGAGGAAGCAGAACAGAT...AAAGTTTCGAGTTAGTTGAAGGTGAGGGTGCT</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="sec-biostrings.html#cb202-1" tabindex="-1"></a><span class="fu">letterFrequency</span>(chr2L_dna, <span class="st">"GC"</span>, <span class="at">as.prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##            G|C
## [1,] 0.4190165</code></pre>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Using <code>letterFrequency</code>, calculate the number and frequency of A, G, C
and T nucleotides in chromosome 2L.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="msmb-solution">
<p class="solution-begin">
► Solution<span id="sol-start-23" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-23', 'sol-start-23')"></span>
</p>
<div id="sol-body-23" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="sec-biostrings.html#cb204-1" tabindex="-1"></a><span class="fu">letterFrequency</span>(chr2L_dna, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>))</span></code></pre></div>
<pre><code>##            A       G       C       T
## [1,] 6512712 4697776 4691476 6505770</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="sec-biostrings.html#cb206-1" tabindex="-1"></a><span class="fu">letterFrequency</span>(chr2L_dna, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>), <span class="at">as.prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##              A         G         C         T
## [1,] 0.2906444 0.2096488 0.2093677 0.2903346</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="additional-exercises-3" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> Additional exercises<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('additional-exercises-3')" onmouseout="reset_tooltip('additional-exercises-3-tooltip')"><span class="tooltiptext" id="additional-exercises-3-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Focusing on the region from base 10 million to 11 million along
chromosome 2L, calculate the GC content across a sliding window of
5000 nucleotides (you can use the <code>letterFrequencyInSlidingView</code>
function) and visualise it (see an example below). On that plot, show
the mean GC content and highlight the regions that have a GC content &gt;
0.5 and &lt; 0.35.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-21"></span>
<p class="caption marginnote shownote">
Figure 4.1: GC content for chomosome 2L (10 - 11 Mb)
</p>
<img src="WSBIM1322_files/figure-html/unnamed-chunk-21-1.png" alt="GC content for chomosome 2L (10 - 11 Mb)" width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Visit the UniProt web page at
<a href="https://www.uniprot.org/">https://www.uniprot.org/</a> and download the
manually reviewed complete human proteome (containing about 20500
proteins). To do so, choose <em>Proteomes</em> on the main page, then search
for <em>Homo sapiens</em>, select it among the list of hits, choose the
reviewed Swiss-Prot release, and download all entries in compressed
fasta format (see <a href="https://youtu.be/K-MVjwZzSoY">video</a>).</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Load the file into R. Beware though that these are protein sequences,
composed of amino acids. Read the <code>?readDNAStringSet</code> manual page to
find a more appropriate function. How many sequences are there? What’s
the average. max and min length of the proteins?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Load the <code>up_selected</code> data from the <code>rWSBIM1322</code> data (version 0.1.1
or later) and use it to create a subset of the object created
above. To to so, you will need to match the protein identifiers from
that vector and the names of the <code>AAStringSet</code> above.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Among the proteins of interest (that where also found in the original
data), how many match the following patterns: <code>DDVF</code>, <code>DEVF</code> <code>EDVF</code> or
<code>EEVF</code>? Do you consider this to be a high number?</p>
<p>The identification of patterns in sequences (not specifically
biological sequences) is called pattern matching, which defines a
whole syntax to define patterns. In particular, it is possible to
define <em>letter D or E</em> as <code>[DE]</code>. To find the pattern of interest, use
the <code>str_detect</code> function from the <code>stringr</code> package.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>To assess if there is an overrepresentation of that pattern in the
sequences of interest, repeat the calculation on all the other
proteins.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div>
<p style="text-align: center;">
<a href="sec-obj.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-norm.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2025-10-14
 using 
R version 4.5.0 (2025-04-11)
</p>
</div>
</div>



</body>
</html>
